# do-not-return-entity

* 요청이나 응답으로 entity를 사용하지 말자

* jpa를 쓰면 자연스럽게 entity를 반환하고 controller까지 가는 경우가 있다.

* 간편하고 필요한 데이터가 전부 담겨져 있기 때문에 이런 유혹에 빠진다.

* 하지만 entity를 반환하는 것은 안좋은 안티패턴 중 하나다

1. 비즈니스 로직은 서비스 계층에서만 변경해야 한다.
    * 보통 jpa를 사용하면 entity와 domain은 같이 사용하게 된다.
    * entity에는 비즈니스로직들이 담겨 있게 되는데
    * entity를 리턴하게 된다면 controller에서 데이터 변경의 가능성을 주는 것이다.
    * 이것은 캡슐화를 위반하는 것이기도 한다

2. 불필요한 코드들이 뒤섞일 수 있다
    * entity에 필요한 어노테이션과 request, response용 어노테이션은 다르다.
    * entity의 경우에는 @Column이나 @ManyToOne 등이 있고 request의 경우에는 @NotNull 등이 있다.
    * 이런 제약이 한 곳에서 뒤섞인다면 읽기 어려운 코드가 될 것이다

3. 필요 없는 데이터가 전달된다
    * entity를 그대로 보내면 클라이언트에서 필요없는 데이터들까지 전달할 가능성이 높다.
    * 필요없는 데이터를 전달하는건 낭비이기도 하고 이해할 수 없는 코드를 만들게 된다
    * (클라이언트 입장에선 왜 필요 없는 값이 있는지 히스토리가 필요할 수도 있다)

* 다음과 같은 이유로 entity를 반환하기 보단 dto로 필요한 데이터만 추출해서 리턴하도록 하자